{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <title>Annuaire</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" type="text/css"  href="{% static 'css/style.css' %}">
        <!-- Lien CSS Bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <style>
            *{ 
    padding: 0;
    margin: 0;
    box-sizing: border-box;
} 

html,body{
    width: 100%;
    background-size: cover;
    background-repeat: no-repeat;
    background-color: rgb(230, 231, 231);
    height: 100%;
    min-height: 270vh;
    display: flex;
    flex-direction: column;
}
nav{
    width: 100%;
    background-color: #fff;
    height: 70px;
    top: 0;
    position: sticky;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

ul{
    list-style: none;
}

ul li{
    display: inline-block;
    position: relative;
    width: 230px;
    
}

ul li a {
    display: block;
    padding: 10px;
    color: black;
    text-decoration: none;
    text-align: center;
    font-size: 15px;
    margin-right: 2em;
}

ul li ul.liste li{
    display: flex;
}

ul li ul.liste li:hover{
    display: flex;
    color: #fff;
}

ul li ul.liste li a:hover{
    background-color: rgb(242, 179, 20);
    color: #fff;
}

ul li ul.liste li img{
    width: 30px;
    height: 30px;
}

ul li ul.liste li img:hover{
    background-color: rgb(242, 179, 20);
}

ul li ul.liste{
    width: 230px;
    background:#fff ;
    position: absolute;
    z-index: 999;
    display: none;
    border-radius: 0.5em;
}

ul li a:hover{
    background: #fff;
}
ul li:hover ul.liste{
    display: block;
}

img{
    width: 80px;
    height: 70px;
   
}

.logo{
    position: absolute;
    left: 40px;
}
.menu-deroulant{
    display: flex;
    justify-content: space-between;
    position: absolute;
    left: 200px;
    text-decoration: none;
    padding: 5px;
}

.menu-deroulant .Annuaire, .ressource{
    margin-right: 20px;
}



.menu-deroulant a{
    text-decoration: none;
    color: black;
}

.menu-deroulant a:hover{
    color: rgb(242, 179, 20);
}
.connexion{
     position: absolute;
     right: 90px;
     background-color: rgb(242, 179, 20);
     border-radius: 10px;
     width: 100px;
     height: 40px;
     text-align: center;
     display: flex;
     align-items: center;
     justify-content: center;
}
.connexion a{
     text-decoration: none;
     color: #fff;
     
}

.formulaire{
    width: 1000px;
    height: 100px;
    background-color: rgb(242, 179, 20);
    display: flex;
    align-items: center;
    text-align: center;
    margin-left: 100px;
    justify-content: center;
}

.input {
    height: 50px;
    max-width: 400px;
    width: 100%;
    border: 1px solid grey;
    border-radius: 100px;
    overflow: hidden;
    padding: 5px;
    flex-grow: 1;
}

 button {
border: 1px solid grey;;
cursor: pointer;
font-size: 1rem;
border-radius: 50%;
margin-left: 40px;
width: 50px;
height: 50px;
}

/* Footer styles */
.foot {
background-color: #2c3e50; /* Couleur de fond */
color: white; /* Couleur du texte */
height: 150px;
}

.footer-bot {
text-align: center;
font-size: 0.8rem;
color: #bdc3c7;
}
.footer-bottom img{
     width: 50px;
     height: 40px;
}



    main{
        flex: 1; 
    }
    main h2{
        text-align: center;
        color: black;
        font-size: 30px;
        margin-top: 50px;
    }

    .cadre-contact{
       display: flex;
       flex-wrap: wrap;
       justify-content: center;
       gap: 20px;
       margin-top: 100px;
    }


    .info-contact{
        
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            width: 270px;
            text-align: left;
        
    }
   
    .contact-tooltip {
            visibility: hidden;
            background-color: #f9f9f9;
            color: black;
            text-align: left;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ccc;
            position: absolute;
            z-index: 1;
            width: 350px;
            top: 120px;
            left: 220px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }


    .info-contact:hover .contact-tooltip {
    visibility: visible;
    opacity: 1;
}

    .info-contact p {
            margin: 5px 0;
            color: black;
            font-size: 13px;
        }

        .info-contact .profession{
           font-style: italic;
           color: rgb(242, 179, 20);
        }

        .list-info-contact .nom{
           font-weight: bold;
           
        }

        .lien-contact {
            text-decoration: none;
        }

        .image-contact{
            background-color: rgb(242, 179, 20);
            display: flex;
            justify-content: center;
            height: 130px;
        }

        .image-contact img{
            
            width: 120px;
            height: 120px;
        }
@media (max-width: 768px) {
th, td {
            font-size: 12px;
            padding: 5px;
        }
    } 
        </style>
    </head>
    <body>
        <nav>
                <div class="logo">
                    <img src="{% static 'images\Logo-Okwelians-removebg-preview.png' %}" alt="">
                </div>
                <div class="menu-deroulant">
                   
                                <a href="{% url 'List_Général' %}" class="Annuaire">Annuaire des membres</a>
                                <a href="{% url 'Liste_personne_ressource' %}" class="ressource">Personnes ressources</a>
                                <a href="{% url 'Liste_lauréats' %}" >Extraire les contacts</a>
                                
                       
                </div>
                
                
                <div class="connexion"><a href="">Se connecter</a></div> 
        </nav>
    <main>
        <h2>Annuaire des membres de la communauté</h2>
        
            <form method="get" action="{% url 'List_Général' %}" class="formulaire">
                <input type="text" placeholder="Tapez un Nom, prénom, secteur d'ativité..." aria-label="Rechercher" name="recherche" value="{{query}}" class="input" id = "search">
                <input type="text" placeholder="Tapez un Nom, prénom, secteur d'ativité..." aria-label="Rechercher1" name="recherche1" value="{{query1}}" class="input1" id = "search1">
                <div id="search-results"></div>
                <button type="submit"><i class="fa-solid fa-magnifying-glass"></i></button>
            </form>
            
        
    <div class="cadre-contact">
        {% for row in page_obj %}
        
        <a href="" class="lien-contact"><div class="info-contact">
                
            <div class="image-contact"><img src="{% static 'images\visage.png' %}" alt=""></div>
            <div class="list-info-contact">
                    <p class="nom">{{ row.nom }} {{ row.prénom }}</p>
                    <p>{{ row.téléphone1 }}</p>
                    <p>{{ row.email }}</p>
                    <p class="profession">{{ row.profession }}</p>  
                    
                    <div class="contact-tooltip">
                        <strong>Nom:</strong> {{ row.nom }} <br>
                        <strong>Prénom:</strong> {{ row.prénom }} <br>
                        <strong>Téléphone1:</strong> {{ row.téléphone1 }} <br>
                        <strong>Téléphone2:</strong> {{ row.téléphone2 }} <br>
                        <strong>Email:</strong> {{ row.email }} <br>
                        <strong>Sexe:</strong> {{ row.sexe }} <br>
                        <strong>Age:</strong> {{ row.age }} <br>
                        <strong>Profession:</strong> {{ row.profession }} <br>
                        <strong>Structure:</strong> {{ row.structure }} <br>
                        <strong>Secteur:</strong> {{ row.secteur }} <br>
                        <strong>Secteur d'activité:</strong> {{ row.secteur_activité }} <br>
                        <strong>Pays de résidence:</strong> {{ row.pays_de_résidence }} <br>
                        <strong>Département de résidence:</strong> {{ row.département_de_résidence }} <br>
                        <strong>Ville de résidence:</strong> {{ row.ville_de_résidence }} <br>
                        <strong>Région d'origine:</strong> {{ row.région_origine }} <br>
                    </div>
                </div>
            </div>
            {% endfor %}
        </a>
    </div>
</main>

<script>
    $(document).ready(function(){
        $("#search").keyup(function(){
            let query = $(this).val();

            if (query.length > 0) {
                $.ajax({
                    url: "/",
                    type: "GET",
                    data: {'q': query},
                    dataType: "json",
                    success: function(data) {
                        let results = data.results;
                        let resultsDiv = $("#search-results");
                        resultsDiv.empty().show();
                        
                        if (results.length > 0) {
                            results.forEach(row => {
                                resultsDiv.append(`
                                    <div class="result-item" onclick="selectResult('${row.nom}', '${row.email}')">
                                        <strong>${row.nom}</strong> - ${row.email} 
                                    </div>
                                `);
                            });
                        } else {
                            resultsDiv.append(`<div class="result-item">Aucun résultat</div>`);
                        }
                    }
                });
            } else {
                $("#search-results").hide();
            }
        });
    });

    function selectResult(nom, email) {
        $("#search").val(nom);
        $("#search-results").hide();
    }

    $(document).ready(function(){
        $("#search1").keyup(function(){
            let query1 = $(this).val();

            if (query1.length > 0) {
                $.ajax({
                    url: "/",
                    type: "GET",
                    data: {'q': query},
                    dataType: "json",
                    success: function(data) {
                        let results = data.results;
                        let resultsDiv = $("#search-results");
                        resultsDiv.empty().show();
                        
                        if (results.length > 0) {
                            results.forEach(row => {
                                resultsDiv.append(`
                                    <div class="result-item" onclick="selectResult('${row.nom}', '${row.email}')">
                                        <strong>${row.nom}</strong> - ${row.email} 
                                    </div>
                                `);
                            });
                        } else {
                            resultsDiv.append(`<div class="result-item">Aucun résultat</div>`);
                        }
                    }
                });
            } else {
                $("#search-results").hide();
            }
        });
    });

    function selectResult(nom, email) {
        $("#search1").val(nom);
        $("#search-results").hide();
    }
</script>
        <footer class="foot">
            <div class="footer-bot">
            <img src="{% static 'images\the-okwelians.png' %}" alt="">
              <p>&copy; The Okwelians</p>
            </div>
          </footer>
        
    </body>
</html>